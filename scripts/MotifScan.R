
-#if (!requireNamespace("BiocManager", quietly = TRUE))
#  install.packages("BiocManager")
#BiocManager::install("Biostrings", version = "3.8")

#if (!requireNamespace("BiocManager", quietly = TRUE))
#  install.packages("BiocManager")
#BiocManager::install("BSgenome", version = "3.8")

#if (!requireNamespace("BiocManager", quietly = TRUE))
#  install.packages("BiocManager")
#BiocManager::install("BSgenome.Hsapiens.UCSC.hg38", version = "3.8")

if (!requireNamespace("BiocManager", quietly = TRUE))
  install.packages("BiocManager")
BiocManager::install("BSgenome.Hsapiens.UCSC.hg19", version = "3.8")

library(Biostrings)
library(BSgenome.Hsapiens.UCSC.hg38)
library(BSgenome.Hsapiens.UCSC.hg19)

BRCA1 <- matrix(c(0.037037,0.192593,0.066667,0.703703,
                  0.303704,0.607407,0.066667,0.022222,
                  0.044444,0.014815,0.037037,0.903704,
                  0.000000,1.000000,0.000000,0.000000,
                  0.037037,0.000000,0.962963,0.000000,
                  0.000000,1.000000,0.000000,0.000000,
                  0.000000,0.000000,1.000000,0.000000,
                  0.866668,0.044444,0.081481,0.007407,
                  0.000000,0.007407,0.977778,0.014815,
                  0.962963,0.000000,0.037037,0.000000), nrow=4)

JUND <- matrix(c(0.418269,0.168269,0.413462,0.000000,
                 0.000000,0.000000,0.000000,1.000000,
                 0.000000,0.000000,0.927885,0.072115,
                 0.980769,0.000000,0.019231,0.000000,
                 0.004808,0.937499,0.019231,0.038462,
                 0.081731,0.033654,0.879807,0.004808,
                 0.000000,0.000000,0.000000,1.000000,
                 0.072115,0.927885,0.000000,0.000000,
                 0.995192,0.000000,0.000000,0.004808,
                 0.004808,0.461538,0.096154,0.437500), nrow=4)

BDP1 <- matrix(c(0.065217, 0.826088, 0.065217, 0.043478,
                 0.217391, 0.630435, 0.021739, 0.130435,
                 0.260870, 0.326087, 0.195652, 0.217391,
                 0.043478, 0.043478, 0.847827, 0.065217,
                 0.021739, 0.000000, 0.956522, 0.021739,
                 0.630435 ,0.195652, 0.108696, 0.065217,
                 0.282609, 0.065217, 0.652174, 0.000000,
                 0.043478, 0.021739, 0.891305, 0.043478,
                 0.195652, 0.065217, 0.695653, 0.043478,
                 0.000000, 1.000000, 0.000000, 0.000000,
                 0.043478, 0.021739, 0.065217, 0.869566,
                 0.000000, 0.152174, 0.239130, 0.608696,
                 0.000000, 1.000000, 0.000000, 0.000000,
                 0.021739, 0.913044, 0.043478, 0.021739,
                 0.021739, 0.152174, 0.086957, 0.739130,
                 0.021739, 0.000000, 0.978261, 0.000000,
                 0.000000, 0.021739, 0.956522, 0.021739,
                 0.934783, 0.021739, 0.000000, 0.043478,
                 0.065217, 0.000000, 0.934783, 0.000000,
                 0.000000, 0.000000, 1.000000, 0.000000,
                 0.782608, 0.086957, 0.043478, 0.086957,
                 0.065217, 0.000000, 0.934783, 0.000000,
                 0.000000, 0.021739, 0.978261, 0.000000), nrow=4)

BDP2 <- matrix(c(0.079545, 0.022727, 0.857955, 0.039773,
                  0.079545, 0.028409, 0.846591, 0.045455,
                  0.551136, 0.136364, 0.204545, 0.107955,
                  0.045455, 0.227273, 0.096591, 0.630681,
                  0.034091, 0.107955, 0.119318, 0.738636,
                  0.056818, 0.721591, 0.125000, 0.096591,
                  0.051136, 0.068182, 0.818182, 0.062500,
                  0.772727, 0.085227, 0.102273, 0.039773,
                  0.744318, 0.068182, 0.142045, 0.045455,
                  0.073864, 0.732954, 0.107955, 0.085227), nrow=4)

BDP3 <- matrix(c( 0.000000, 0.486842, 0.513158, 0.000000,
                  0.302632, 0.223684, 0.263158, 0.210526,
                  0.223684, 0.263158, 0.263158, 0.250000,
                  0.289474, 0.210526, 0.328947, 0.171053,
                  0.381579, 0.000000, 0.368421, 0.250000,
                  0.434211, 0.000000, 0.565789, 0.000000,
                  0.000000, 0.000000, 1.000000, 0.000000,
                  0.000000, 0.565789, 0.434211, 0.000000,
                  0.315789, 0.144737, 0.078947, 0.460526,
                  0.000000, 0.394737, 0.605263, 0.000000,
                  0.381579, 0.000000, 0.184211, 0.434211,
                  0.000000, 0.000000, 1.000000, 0.000000,
                  0.421053, 0.000000, 0.578947, 0.000000,
                  0.000000, 0.394737, 0.605263, 0.000000), nrow=4)

BHLHE40_known1 <- matrix(c( 0.260870, 0.260870, 0.173913, 0.304348,
                            0.217391, 0.217391, 0.391304, 0.173913,
                            0.260870, 0.347826, 0.391304, 0.000000,
                            0.043478, 0.000000, 0.130435, 0.826087,
                            0.000000, 1.000000, 0.000000, 0.000000,
                            1.000000, 0.000000, 0.000000, 0.000000,
                            0.000000, 1.000000, 0.000000, 0.000000,
                            0.043478, 0.000000, 0.956522, 0.000000,
                            0.000000, 0.000000, 0.000000, 1.000000,
                            0.000000, 0.000000, 1.000000, 0.000000,
                            0.739131, 0.217391, 0.043478, 0.000000,
                            0.086957, 0.434783, 0.347826, 0.130435,
                            0.391304, 0.130435, 0.391304, 0.086957,
                            0.173913, 0.304348, 0.391304, 0.130435), nrow=4)

BHLHE40_known2 <- matrix(c( 0.347837, 0.112349, 0.403713, 0.136102,
                            0.298329, 0.175329, 0.324534, 0.201809,
                            0.421791, 0.222553, 0.113615, 0.242041,
                            0.387506, 0.130670, 0.161435, 0.320389,
                            0.197183, 0.244864, 0.304611, 0.253342,
                            0.345884, 0.188786, 0.278290, 0.187041,
                            0.228203, 0.142148, 0.408269, 0.221381,
                            0.037126, 0.006772, 0.231775, 0.724327,
                            0.055214, 0.942800, 0.001192, 0.000794,
                            0.974119, 0.004466, 0.015535, 0.005880,
                            0.000300, 0.958146, 0.007498, 0.034056,
                            0.034056, 0.007498, 0.958146, 0.000300,
                            0.005880, 0.015535, 0.004466, 0.974119,
                            0.000794, 0.001192, 0.942800, 0.055214,
                            0.724327, 0.231775, 0.006772, 0.037126,
                            0.015720, 0.466476, 0.315208, 0.202596,
                            0.173670, 0.355170, 0.210710, 0.260449,
                            0.407419, 0.261539, 0.134430, 0.196612,
                            0.351478, 0.209698, 0.262426, 0.176399,
                            0.207869, 0.284582, 0.198951, 0.308598,
                            0.434482, 0.113724, 0.184408, 0.267386,
                            0.211144, 0.363745, 0.173978, 0.251133),nrow=4)

AP1_disc1 <- matrix(c( 0.418269, 0.168269, 0.413462, 0.000000,
                       0.000000, 0.000000, 0.000000, 1.000000,
                       0.000000, 0.000000, 0.927885, 0.072115,
                       0.980769, 0.000000, 0.019231, 0.000000,
                       0.004808, 0.937499, 0.019231, 0.038462,
                       0.081731, 0.033654, 0.879807, 0.004808,
                       0.000000, 0.000000, 0.000000, 1.000000,
                       0.072115, 0.927885, 0.000000, 0.000000,
                       0.995192, 0.000000, 0.000000, 0.004808,
                       0.004808, 0.461538, 0.096154, 0.437500), nrow=4)

CHD2_disc1 <- matrix(c( 0.000000, 0.141509, 0.000000, 0.858491,
                        0.193396, 0.740566, 0.066038, 0.000000,
                        0.000000, 0.000000, 0.000000, 1.000000,
                        0.000000, 1.000000, 0.000000, 0.000000,
                        0.018868, 0.000000, 0.981132, 0.000000,
                        0.000000, 0.981132, 0.000000, 0.018868,
                        0.000000, 0.000000, 1.000000, 0.000000,
                        1.000000, 0.000000, 0.000000, 0.000000,
                        0.000000, 0.066038, 0.783019, 0.150943,
                        1.000000, 0.000000, 0.000000, 0.000000), nrow=4)

rownames(BRCA1) <- c('A','C','G','T')
rownames(JUND) <- c('A','C','G','T')
rownames(BDP1) <- c('A','C','G','T')
rownames(BDP2) <- c('A','C','G','T')
rownames(BDP3) <- c('A','C','G','T')
rownames(AP1_disc1) <- c('A','C','G','T')
rownames(CHD2_disc1) <- c('A','C','G','T')


motif_interval_gen <- function(chr_num, pwm){
  chr <- BSgenome.Hsapiens.UCSC.hg38[[chr_num]]
  chr_hits <- matchPWM(pwm, chr, min.score = "90%", with.score = TRUE)
  chr_rev_hits <- matchPWM(reverseComplement(pwm), chr, min.score = "90%", with.score = TRUE)
  intervals <- data.frame("chr"=chr_num,"start"=start(chr_hits),"end"=end(chr_hits),"seq"=as.character(chr_hits))
  return(intervals)
}

output <- data.frame(chr=character(),start=numeric(),end=numeric(),seq=character())
#22
for (i in 1:22){
  output<- rbind(output,motif_interval_gen(sprintf("chr%s",i),CHD2_disc1))
}

output<- rbind(output,motif_interval_gen("chrX",CHD2_disc1))
output<- rbind(output,motif_interval_gen("chrY",CHD2_disc1))

write.table(output, file="motif_CHD2_disc1.bed", sep="\t", row.names=FALSE, quote=FALSE, col.names=FALSE)

